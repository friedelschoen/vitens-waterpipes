<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitens Waterflow</title>
    <link href="app.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="shortcut icon" href="image.png" type="image/x-icon">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&family=Roboto:ital,wght@0,100..900;1,100..900&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
</head>

<body class="bg-gray-100 flex min-h-screen">
    <div class="bg-vitens-100 text-white w-64 p-6 flex flex-col">
        <h1 class="mb-6 flex justify-center">
            <img src="img/Untitled_design-removebg-preview 1.svg" alt="Vitens Logo" class="w-20 h-auto">
            <img src="img/Group 2.svg" alt="Vitens Logo" class="w-32 h-auto">
        </h1>
        <nav class="flex flex-col gap-4">
            <div class="flex items-center relative">
                <input type="text" placeholder="Search..."
                    class="text-black border border-gray-300 rounded-lg py-2 px-4 w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button class="absolute right-2 top-2 text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mt-1" fill="currentColor"
                        viewBox="0 0 24 24">
                        <path
                            d="M10 2a8 8 0 1 0 5.29 14.71l4 4a1 1 0 0 0 1.42-1.42l-4-4A8 8 0 0 0 10 2zm0 2a6 6 0 1 1 0 12A6 6 0 0 1 10 4z" />
                    </svg>
                </button>
            </div>
            <button id="flowButton"
                class="flex items-center gap-2 bg-gray-700 hover:bg-gray-400 font-roboto blueTXT font-semibold py-2 px-4 rounded transition active"
                onclick="window.location.href='index.html'">
                <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M7.90625 1.07812C7.90625 0.480664 7.42559 0 6.82812 0C6.23066 0 5.75 0.480664 5.75 1.07812V2.875C4.16426 2.875 2.875 4.16426 2.875 5.75H1.07812C0.480664 5.75 0 6.23066 0 6.82812C0 7.42559 0.480664 7.90625 1.07812 7.90625H2.875V10.4219H1.07812C0.480664 10.4219 0 10.9025 0 11.5C0 12.0975 0.480664 12.5781 1.07812 12.5781H2.875V15.0938H1.07812C0.480664 15.0938 0 15.5744 0 16.1719C0 16.7693 0.480664 17.25 1.07812 17.25H2.875C2.875 18.8357 4.16426 20.125 5.75 20.125V21.9219C5.75 22.5193 6.23066 23 6.82812 23C7.42559 23 7.90625 22.5193 7.90625 21.9219V20.125H10.4219V21.9219C10.4219 22.5193 10.9025 23 11.5 23C12.0975 23 12.5781 22.5193 12.5781 21.9219V20.125H15.0938V21.9219C15.0938 22.5193 15.5744 23 16.1719 23C16.7693 23 17.25 22.5193 17.25 21.9219V20.125C18.8357 20.125 20.125 18.8357 20.125 17.25H21.9219C22.5193 17.25 23 16.7693 23 16.1719C23 15.5744 22.5193 15.0938 21.9219 15.0938H20.125V12.5781H21.9219C22.5193 12.5781 23 12.0975 23 11.5C23 10.9025 22.5193 10.4219 21.9219 10.4219H20.125V7.90625H21.9219C22.5193 7.90625 23 7.42559 23 6.82812C23 6.23066 22.5193 5.75 21.9219 5.75H20.125C20.125 4.16426 18.8357 2.875 17.25 2.875V1.07812C17.25 0.480664 16.7693 0 16.1719 0C15.5744 0 15.0938 0.480664 15.0938 1.07812V2.875H12.5781V1.07812C12.5781 0.480664 12.0975 0 11.5 0C10.9025 0 10.4219 0.480664 10.4219 1.07812V2.875H7.90625V1.07812ZM7.1875 5.75H15.8125C16.6076 5.75 17.25 6.39238 17.25 7.1875V15.8125C17.25 16.6076 16.6076 17.25 15.8125 17.25H7.1875C6.39238 17.25 5.75 16.6076 5.75 15.8125V7.1875C5.75 6.39238 6.39238 5.75 7.1875 5.75ZM15.8125 7.1875H7.1875V15.8125H15.8125V7.1875Z"
                        fill="black" />
                </svg>
                Flow
            </button>
            <a href="index.html?view=pressure"
                class="flex items-center gap-2 bg-gray-700 hover:bg-gray-400 font-roboto blueTXT font-semibold py-2 px-4 rounded transition">
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M0 11C0 8.08262 1.15893 5.28473 3.22183 3.22183C5.28473 1.15893 8.08262 0 11 0C13.9174 0 16.7153 1.15893 18.7782 3.22183C20.8411 5.28473 22 8.08262 22 11C22 13.9174 20.8411 16.7153 18.7782 18.7782C16.7153 20.8411 13.9174 22 11 22C8.08262 22 5.28473 20.8411 3.22183 18.7782C1.15893 16.7153 0 13.9174 0 11ZM13.75 15.125C13.75 13.9691 13.041 12.9809 12.0312 12.577V3.78125C12.0312 3.20977 11.5715 2.75 11 2.75C10.4285 2.75 9.96875 3.20977 9.96875 3.78125V12.577C8.95898 12.9852 8.25 13.9734 8.25 15.125C8.25 16.6418 9.4832 17.875 11 17.875C12.5168 17.875 13.75 16.6418 13.75 15.125ZM6.1875 7.5625C6.55217 7.5625 6.90191 7.41763 7.15977 7.15977C7.41763 6.90191 7.5625 6.55217 7.5625 6.1875C7.5625 5.82283 7.41763 5.47309 7.15977 5.21523C6.90191 4.95737 6.55217 4.8125 6.1875 4.8125C5.82283 4.8125 5.47309 4.95737 5.21523 5.21523C4.95737 5.47309 4.8125 5.82283 4.8125 6.1875C4.8125 6.55217 4.95737 6.90191 5.21523 7.15977C5.47309 7.41763 5.82283 7.5625 6.1875 7.5625ZM5.5 11C5.5 10.6353 5.35513 10.2856 5.09727 10.0277C4.83941 9.76987 4.48967 9.625 4.125 9.625C3.76033 9.625 3.41059 9.76987 3.15273 10.0277C2.89487 10.2856 2.75 10.6353 2.75 11C2.75 11.3647 2.89487 11.7144 3.15273 11.9723C3.41059 12.2301 3.76033 12.375 4.125 12.375C4.48967 12.375 4.83941 12.2301 5.09727 11.9723C5.35513 11.7144 5.5 11.3647 5.5 11ZM17.875 12.375C18.2397 12.375 18.5894 12.2301 18.8473 11.9723C19.1051 11.7144 19.25 11.3647 19.25 11C19.25 10.6353 19.1051 10.2856 18.8473 10.0277C18.5894 9.76987 18.2397 9.625 17.875 9.625C17.5103 9.625 17.1606 9.76987 16.9027 10.0277C16.6449 10.2856 16.5 10.6353 16.5 11C16.5 11.3647 16.6449 11.7144 16.9027 11.9723C17.1606 12.2301 17.5103 12.375 17.875 12.375ZM17.1875 6.1875C17.1875 5.82283 17.0426 5.47309 16.7848 5.21523C16.5269 4.95737 16.1772 4.8125 15.8125 4.8125C15.4478 4.8125 15.0981 4.95737 14.8402 5.21523C14.5824 5.47309 14.4375 5.82283 14.4375 6.1875C14.4375 6.55217 14.5824 6.90191 14.8402 7.15977C15.0981 7.41763 15.4478 7.5625 15.8125 7.5625C16.1772 7.5625 16.5269 7.41763 16.7848 7.15977C17.0426 6.90191 17.1875 6.55217 17.1875 6.1875Z"
                        fill="black" />
                </svg>
                Pressure
            </a>

            <button id="valveButton"
                class="flex items-center gap-2 bg-gray-700 hover:bg-gray-400 font-roboto blueTXT font-semibold py-2 px-4 rounded transition"
                onclick="window.location.href='valves.html'">
                <svg width="22" height="24" viewBox="0 0 22 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M9.66665 6.66667V2.66667H4.33331V0H17.6666V2.66667H12.3333V6.66667H9.66665ZM0.333313 24V13.3333H2.99998V14.6667H6.99998V10.6667H5.66665V8H16.3333V10.6667H15V14.6667H19V13.3333H21.6666V24H19V22.6667H2.99998V24H0.333313ZM2.99998 20H19V17.3333H12.3333V10.6667H9.66665V17.3333H2.99998V20Z"
                        fill="black" />
                </svg>

                Valves
            </button>
            <!-- <div class="relative flex flex-col">
                <button id="sensorDropdownButton"
                    class="flex items-center gap-2 bg-gray-700 hover:bg-gray-400 font-roboto blueTXT font-semibold py-2 px-4 rounded transition">
                    <svg id="sensorDropdownIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                        class="w-5 h-5 transition-transform">
                        <path
                            d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z" />
                    </svg>
                    Sensor Toggles
                </button>
                <div id="sensorDropdown"
                    class="absolute top-full bg-white text-black rounded shadow-lg p-4 hidden w-full z-10">
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="sensor-checkbox font-roboto" data-sensor="1" checked>
                        Sensor 1
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="sensor-checkbox font-roboto" data-sensor="2" checked>
                        Sensor 2
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="sensor-checkbox font-roboto" data-sensor="3" checked>
                        Sensor 3
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="sensor-checkbox font-roboto" data-sensor="4" checked>
                        Sensor 4
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="sensor-checkbox font-roboto" data-sensor="5" checked>
                        Sensor 5
                    </label>
                </div>
            </div> -->
        </nav>
    </div>
    <div class="flex-1 flex flex-col bg-gray-100">
        <header class="bg-white shadow-md p-4 flex text-center justify-between">
            <h1 id="pageHeader" class="text-4xl ml-5 font-bold font-mono">Flow Sensors</h1>
        </header>

        <!DOCTYPE html>
        <html lang="en">

        <head>
            <meta charset="UTF-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0" />
            <title>Valves Control</title>
            <!-- Tailwind CSS CDN -->
            <script src="https://cdn.tailwindcss.com"></script>
        </head>

        <body class="bg-gray-100">
            <section id="valves" class="py-12 px-6 sm:px-12">
                <div class="flex flex-wrap justify-center gap-8">

                    <!-- Valve Template -->
                    <!-- Example: Valve 1 -->
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 1</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 1 is now <span id="valve-state-1" class="font-semibold text-red-400">closed</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="1" data-action="open" id="open-btn-1">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="1" data-action="close" id="close-btn-1">
                                Close
                            </button>
                        </div>
                    </div>

                    <!-- Copy the above block and change only text/state for each additional valve -->
                    <!-- Valve 2 -->
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 2</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 2 is now <span id="valve-state-2" class="font-semibold text-red-400">closed</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="2" data-action="open" id="open-btn-2">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="2" data-action="close" id="close-btn-2">
                                Close
                            </button>
                        </div>
                    </div>

                    <!-- Valve 3 -->
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 3</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 3 is now <span id="valve-state-3" class="font-semibold text-green-500">open</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="3" data-action="open" id="open-btn-3">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="3" data-action="close" id="close-btn-3">
                                Close
                            </button>
                        </div>
                    </div>

                    <!-- Valve 4 -->
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 4</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 4 is now <span id="valve-state-4" class="font-semibold text-red-400">closed</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="4" data-action="open" id="open-btn-4">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="4" data-action="close" id="close-btn-4">
                                Close
                            </button>
                        </div>
                    </div>

                    <!-- Valve 5 -->
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 5</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 5 is now <span id="valve-state-5" class="font-semibold text-green-500">open</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="5" data-action="open" id="open-btn-5">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="5" data-action="close" id="close-btn-5">
                                Close
                            </button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl mt-4 p-6 w-72 shadow-md flex flex-col items-center">
                        <h2 class="text-xl font-semibold mb-2 text-gray-800">Valve 6</h2>
                        <p class="mb-4 text-gray-500">
                            Valve 6 is now <span id="valve-state-6" class="font-semibold text-green-500">open</span>
                        </p>
                        <div class="flex gap-4">
                            <button
                                class="bg-neutral-700 hover:bg-neutral-800 text-white font-medium py-2 px-5 rounded transition"
                                data-valve="6" data-action="open" id="open-btn-6">
                                Open
                            </button>
                            <button
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-5 rounded transition"
                                data-valve="6" data-action="close" id="close-btn-6">
                                Close
                            </button>
                        </div>
                    </div>

                </div>
            </section>
        </body>

        </html>


        <footer class="bg-vitens-100 text-white text-center py-4 mt-auto" role="contentinfo">
            <p class="darkerBlueTXT">&copy; 2025 Vitens. All rights reserved.</p>
        </footer>

        <script src="script.js"></script>
        <script>
const NUM_VALVES = 6;

// Initial state: 0 = closed, 1 = open
let valveStates = {1:0, 2:0, 3:1, 4:0, 5:1, 6:1}; // You can fetch this from backend if needed

function updateValveText(valve, state) {
    const stateSpan = document.getElementById(`valve-state-${valve}`);
    if (stateSpan) {
        if (state === 1) {
            stateSpan.textContent = 'open';
            stateSpan.classList.remove('text-red-400');
            stateSpan.classList.add('text-green-500');
        } else {
            stateSpan.textContent = 'closed';
            stateSpan.classList.remove('text-green-500');
            stateSpan.classList.add('text-red-400');
        }
    }
}

function sendValveStates() {
    // Send all states to backend
    for (let valve = 1; valve <= NUM_VALVES; valve++) {
        fetch('http://localhost:5000/api/valve_state', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({valve_number: valve, state: valveStates[valve]})
        });
    }
}

function handleValveButtonClick(e) {
    const valve = parseInt(e.target.getAttribute('data-valve'));
    const action = e.target.getAttribute('data-action');
    if (!valve) return;
    valveStates[valve] = (action === 'open') ? 1 : 0;
    updateValveText(valve, valveStates[valve]);
    sendValveStates();
}

// Attach event listeners
for (let valve = 1; valve <= NUM_VALVES; valve++) {
    const openBtn = document.getElementById(`open-btn-${valve}`);
    const closeBtn = document.getElementById(`close-btn-${valve}`);
    if (openBtn) openBtn.addEventListener('click', handleValveButtonClick);
    if (closeBtn) closeBtn.addEventListener('click', handleValveButtonClick);
    // Set initial text
    updateValveText(valve, valveStates[valve]);
}
</script>
    </div>
</body>

</html>